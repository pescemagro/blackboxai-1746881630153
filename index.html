<html class="scroll-smooth" lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   Decentralized Calendar &amp; Chat App
  </title>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&amp;display=swap" rel="stylesheet"/>
  <style>
   body {
      font-family: 'Inter', sans-serif;
    }
  </style>
 </head>
 <body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen flex flex-col">
  <div class="flex-1 flex flex-col" id="app">
   <!-- Header -->
   <header class="flex items-center justify-between px-4 py-3 border-b border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 sticky top-0 z-20">
    <h1 class="text-xl font-semibold select-none">
     Decentralized Calendar
    </h1>
    <button aria-label="Toggle Light/Dark Mode" class="text-gray-600 dark:text-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 rounded" id="toggleThemeBtn">
     <i class="fas fa-moon dark:hidden">
     </i>
     <i class="fas fa-sun hidden dark:inline">
     </i>
    </button>
   </header>
   <!-- Main content -->
   <main class="flex-1 overflow-auto">
    <!-- Views container -->
    <section class="h-full flex flex-col" id="viewsContainer">
     <!-- Calendar View -->
     <section class="flex flex-col h-full p-4 space-y-4" id="homeView">
      <div class="flex justify-between items-center">
       <h2 class="text-lg font-semibold">
        Calendar
       </h2>
       <div class="flex space-x-2">
        <button class="calendar-view-btn px-3 py-1 rounded-md border border-indigo-600 text-indigo-600 font-medium hover:bg-indigo-50 dark:hover:bg-indigo-700 dark:text-indigo-400 dark:border-indigo-400" data-view="day">
         Day
        </button>
        <button class="calendar-view-btn px-3 py-1 rounded-md border border-indigo-600 text-indigo-600 font-medium hover:bg-indigo-50 dark:hover:bg-indigo-700 dark:text-indigo-400 dark:border-indigo-400" data-view="week">
         Week
        </button>
        <button class="calendar-view-btn px-3 py-1 rounded-md border border-indigo-600 text-indigo-600 font-medium hover:bg-indigo-50 dark:hover:bg-indigo-700 dark:text-indigo-400 dark:border-indigo-400" data-view="month">
         Month
        </button>
       </div>
      </div>
      <!-- Calendar content -->
      <div class="flex-1 overflow-auto rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 p-4" id="calendarContent">
       <!-- Day View -->
       <div class="hidden h-full flex flex-col" id="dayView">
        <div class="text-center font-semibold mb-2">
         Monday, June 10, 2024
        </div>
        <div class="flex flex-col space-y-2 overflow-auto flex-1">
         <div class="border border-indigo-400 rounded p-2 bg-indigo-50 dark:bg-indigo-900">
          <div class="font-semibold">
           09:00 - 10:00
          </div>
          <div>
           Team Standup Meeting
          </div>
          <div class="text-sm text-gray-600 dark:text-gray-400">
           Private
          </div>
         </div>
         <div class="border border-green-400 rounded p-2 bg-green-50 dark:bg-green-900">
          <div class="font-semibold">
           14:00 - 15:30
          </div>
          <div>
           Project Planning with #devgroup
          </div>
          <div class="text-sm text-gray-600 dark:text-gray-400">
           Shared with Group
          </div>
         </div>
         <div class="border border-yellow-400 rounded p-2 bg-yellow-50 dark:bg-yellow-900">
          <div class="font-semibold">
           18:00 - 19:00
          </div>
          <div>
           Dinner with family
          </div>
          <div class="text-sm text-gray-600 dark:text-gray-400">
           Private
          </div>
         </div>
        </div>
       </div>
       <!-- Week View -->
       <div class="hidden h-full flex flex-col" id="weekView">
        <div class="text-center font-semibold mb-2">
         Week of June 9 - June 15, 2024
        </div>
        <div class="grid grid-cols-7 gap-2 flex-1 overflow-auto">
         <div class="border border-gray-300 dark:border-gray-700 rounded p-2 bg-white dark:bg-gray-800 flex flex-col">
          <div class="font-semibold text-center">
           Sun 9
          </div>
          <div class="mt-1 flex-1 space-y-1">
           <div class="text-xs border border-indigo-400 rounded p-1 bg-indigo-50 dark:bg-indigo-900">
            10:00 Meeting with Alice
           </div>
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-2 bg-white dark:bg-gray-800 flex flex-col">
          <div class="font-semibold text-center">
           Mon 10
          </div>
          <div class="mt-1 flex-1 space-y-1">
           <div class="text-xs border border-indigo-400 rounded p-1 bg-indigo-50 dark:bg-indigo-900">
            09:00 Team Standup
           </div>
           <div class="text-xs border border-green-400 rounded p-1 bg-green-50 dark:bg-green-900">
            14:00 Project Planning #devgroup
           </div>
           <div class="text-xs border border-yellow-400 rounded p-1 bg-yellow-50 dark:bg-yellow-900">
            18:00 Dinner
           </div>
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-2 bg-white dark:bg-gray-800 flex flex-col">
          <div class="font-semibold text-center">
           Tue 11
          </div>
          <div class="mt-1 flex-1 space-y-1">
           <div class="text-xs border border-indigo-400 rounded p-1 bg-indigo-50 dark:bg-indigo-900">
            11:00 Doctor Appointment
           </div>
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-2 bg-white dark:bg-gray-800 flex flex-col">
          <div class="font-semibold text-center">
           Wed 12
          </div>
          <div class="mt-1 flex-1 space-y-1">
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-2 bg-white dark:bg-gray-800 flex flex-col">
          <div class="font-semibold text-center">
           Thu 13
          </div>
          <div class="mt-1 flex-1 space-y-1">
           <div class="text-xs border border-red-400 rounded p-1 bg-red-50 dark:bg-red-900">
            16:00 Deadline for report
           </div>
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-2 bg-white dark:bg-gray-800 flex flex-col">
          <div class="font-semibold text-center">
           Fri 14
          </div>
          <div class="mt-1 flex-1 space-y-1">
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-2 bg-white dark:bg-gray-800 flex flex-col">
          <div class="font-semibold text-center">
           Sat 15
          </div>
          <div class="mt-1 flex-1 space-y-1">
          </div>
         </div>
        </div>
       </div>
       <!-- Month View -->
       <div class="hidden h-full flex flex-col" id="monthView">
        <div class="text-center font-semibold mb-2">
         June 2024
        </div>
        <div class="grid grid-cols-7 gap-1 flex-1 overflow-auto text-xs">
         <div class="font-semibold text-center">
          Sun
         </div>
         <div class="font-semibold text-center">
          Mon
         </div>
         <div class="font-semibold text-center">
          Tue
         </div>
         <div class="font-semibold text-center">
          Wed
         </div>
         <div class="font-semibold text-center">
          Thu
         </div>
         <div class="font-semibold text-center">
          Fri
         </div>
         <div class="font-semibold text-center">
          Sat
         </div>
         <!-- Blank days before 1st June 2024 (Saturday) -->
         <div>
         </div>
         <div>
         </div>
         <div>
         </div>
         <div>
         </div>
         <div>
         </div>
         <div>
         </div>
         <!-- Days with events -->
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-indigo-50 dark:bg-indigo-900 relative cursor-pointer">
          <div class="font-semibold">
           1
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           2
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           3
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           4
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           5
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           6
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           7
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-indigo-50 dark:bg-indigo-900 relative cursor-pointer">
          <div class="font-semibold">
           8
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-indigo-50 dark:bg-indigo-900 relative cursor-pointer">
          <div class="font-semibold">
           9
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-indigo-50 dark:bg-indigo-900 relative cursor-pointer">
          <div class="font-semibold">
           10
          </div>
          <div class="text-[8px] text-indigo-700 dark:text-indigo-300">
           Team Standup
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-green-50 dark:bg-green-900 relative cursor-pointer">
          <div class="font-semibold">
           11
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           12
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-red-50 dark:bg-red-900 relative cursor-pointer">
          <div class="font-semibold">
           13
          </div>
          <div class="text-[8px] text-red-700 dark:text-red-300">
           Report Deadline
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           14
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           15
          </div>
         </div>
         <!-- Fill rest of the grid to 42 cells (6 weeks) -->
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           16
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           17
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           18
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           19
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           20
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           21
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           22
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           23
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           24
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           25
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           26
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           27
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           28
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           29
          </div>
         </div>
         <div class="border border-gray-300 dark:border-gray-700 rounded p-1 bg-white dark:bg-gray-800 relative cursor-pointer">
          <div class="font-semibold">
           30
          </div>
         </div>
        </div>
       </div>
      </div>
     </section>
     <!-- Chats View -->
     <section class="hidden h-full flex flex-col p-4 space-y-4" id="chatsView">
      <div class="flex justify-between items-center">
       <h2 class="text-lg font-semibold">
        Chats
       </h2>
       <button class="flex items-center space-x-2 px-3 py-1 rounded-md bg-indigo-600 text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500" id="newConnectionBtn">
        <i class="fas fa-plus">
        </i>
        <span>
         New Connection
        </span>
       </button>
      </div>
      <div class="flex flex-col md:flex-row md:space-x-4 h-full">
       <!-- Connections List -->
       <div class="md:w-1/3 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 flex flex-col">
        <div class="p-2 border-b border-gray-300 dark:border-gray-700 font-semibold">
         Connections
        </div>
        <ul class="flex-1 overflow-auto divide-y divide-gray-200 dark:divide-gray-700" id="connectionsList">
         <li class="flex items-center p-2 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900" data-connection-id="1">
          <img alt="Avatar of Alice, a young woman with short brown hair and glasses" class="w-10 h-10 rounded-full object-cover" height="40" src="https://storage.googleapis.com/a1aa/image/e945a530-68b2-4781-c4b9-626904ef78f6.jpg" width="40"/>
          <div class="ml-3 flex-1">
           <div class="flex justify-between items-center">
            <span class="font-semibold">
             Alice
            </span>
            <span class="text-xs text-gray-500 dark:text-gray-400">
             Online
            </span>
           </div>
           <div class="text-xs text-gray-600 dark:text-gray-400">
            Last seen: now
           </div>
          </div>
         </li>
         <li class="flex items-center p-2 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900" data-connection-id="2">
          <img alt="Avatar of Bob, a middle-aged man with beard and glasses" class="w-10 h-10 rounded-full object-cover" height="40" src="https://storage.googleapis.com/a1aa/image/4d78e3da-6f5d-49b7-368c-9c96023058e3.jpg" width="40"/>
          <div class="ml-3 flex-1">
           <div class="flex justify-between items-center">
            <span class="font-semibold">
             Bob
            </span>
            <span class="text-xs text-gray-500 dark:text-gray-400">
             Offline
            </span>
           </div>
           <div class="text-xs text-gray-600 dark:text-gray-400">
            Last seen: 2 hours ago
           </div>
          </div>
         </li>
         <li class="flex items-center p-2 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900" data-connection-id="3">
          <img alt="Avatar of Charlie, a young man with short black hair and a friendly smile" class="w-10 h-10 rounded-full object-cover" height="40" src="https://storage.googleapis.com/a1aa/image/b42bfa16-4dda-49ba-a9c6-559827d4a5f5.jpg" width="40"/>
          <div class="ml-3 flex-1">
           <div class="flex justify-between items-center">
            <span class="font-semibold">
             Charlie
            </span>
            <span class="text-xs text-gray-500 dark:text-gray-400">
             Online
            </span>
           </div>
           <div class="text-xs text-gray-600 dark:text-gray-400">
            Last seen: 5 minutes ago
           </div>
          </div>
         </li>
         <li class="flex items-center p-2 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900" data-connection-id="4">
          <img alt="Avatar of Denise, a woman with long blonde hair and a warm smile" class="w-10 h-10 rounded-full object-cover" height="40" src="https://storage.googleapis.com/a1aa/image/4312ece6-2e71-480d-22e5-2fd6dd6c9ad0.jpg" width="40"/>
          <div class="ml-3 flex-1">
           <div class="flex justify-between items-center">
            <span class="font-semibold">
             Denise
            </span>
            <span class="text-xs text-gray-500 dark:text-gray-400">
             Offline
            </span>
           </div>
           <div class="text-xs text-gray-600 dark:text-gray-400">
            Last seen: yesterday
           </div>
          </div>
         </li>
         <li class="flex items-center p-2 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900" data-connection-id="5">
          <img alt="Avatar of Emily, a young woman with curly hair and bright eyes" class="w-10 h-10 rounded-full object-cover" height="40" src="https://storage.googleapis.com/a1aa/image/74c69880-fc99-408b-9efb-bb11de434875.jpg" width="40"/>
          <div class="ml-3 flex-1">
           <div class="flex justify-between items-center">
            <span class="font-semibold">
             Emily
            </span>
            <span class="text-xs text-gray-500 dark:text-gray-400">
             Online
            </span>
           </div>
           <div class="text-xs text-gray-600 dark:text-gray-400">
            Last seen: 10 minutes ago
           </div>
          </div>
         </li>
        </ul>
       </div>
       <!-- Chat Window -->
       <div class="md:flex-1 flex flex-col border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800">
        <div class="p-3 border-b border-gray-300 dark:border-gray-700 flex items-center space-x-3" id="chatHeader">
         <img alt="Avatar of chat user" class="w-10 h-10 rounded-full object-cover" height="40" id="chatAvatar" src="https://storage.googleapis.com/a1aa/image/d3cf35bd-fc6b-4c25-d041-522b5d138281.jpg" width="40"/>
         <div>
          <div class="font-semibold" id="chatName">
           Alice
          </div>
          <div class="text-xs text-gray-600 dark:text-gray-400" id="chatStatus">
           Online - Last seen: now
          </div>
         </div>
        </div>
        <div class="flex-1 p-3 overflow-auto space-y-3" id="chatMessages">
         <div class="flex justify-start">
          <div class="bg-indigo-100 dark:bg-indigo-700 text-indigo-900 dark:text-indigo-100 rounded-lg px-3 py-2 max-w-xs break-words">
           Hey! How are you?
          </div>
         </div>
         <div class="flex justify-end">
          <div class="bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 max-w-xs break-words">
           I'm good, thanks! Just working on the project.
          </div>
         </div>
         <div class="flex justify-start">
          <img alt="Photo sent by Alice showing a scenic mountain landscape with a clear blue sky" class="rounded-lg max-w-xs" height="100" src="https://storage.googleapis.com/a1aa/image/399e01d8-a7c6-4460-add0-9ba4b8fdf56b.jpg" width="150"/>
         </div>
         <div class="flex justify-end">
          <div class="bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 max-w-xs break-words">
           Looks amazing! Can you send the file?
          </div>
         </div>
         <div class="flex justify-start">
          <a class="inline-block bg-indigo-100 dark:bg-indigo-700 text-indigo-900 dark:text-indigo-100 rounded px-3 py-1 max-w-xs truncate" download="project-doc.pdf" href="#" title="Download project-doc.pdf">
           <i class="fas fa-file-pdf mr-2">
           </i>
           project-doc.pdf
          </a>
         </div>
         <div class="flex justify-end">
          <div class="bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 max-w-xs break-words">
           👍😊
          </div>
         </div>
        </div>
        <form class="p-3 border-t border-gray-300 dark:border-gray-700 flex items-center space-x-2" id="chatForm">
         <button aria-label="Insert Emoji" class="text-2xl hover:text-indigo-600 dark:hover:text-indigo-400 focus:outline-none" id="emojiBtn" type="button">
          😊
         </button>
         <input autocomplete="off" class="flex-1 rounded border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 px-3 py-2 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-500" id="chatInput" placeholder="Type a message..." type="text"/>
         <button aria-label="Attach File or Image" class="text-xl hover:text-indigo-600 dark:hover:text-indigo-400 focus:outline-none" id="attachBtn" type="button">
          <i class="fas fa-paperclip">
          </i>
         </button>
         <button aria-label="Send Message" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded focus:outline-none focus:ring-2 focus:ring-indigo-500" type="submit">
          Send
         </button>
         <input accept="image/*,application/pdf,.doc,.docx,.txt" class="hidden" id="fileInput" type="file"/>
        </form>
       </div>
      </div>
     </section>
     <!-- Create Post View -->
     <section class="hidden h-full flex flex-col p-4 space-y-4" id="createPostView">
      <h2 class="text-lg font-semibold">
       Create Post
      </h2>
      <form class="flex flex-col space-y-4" id="postForm">
       <label class="block text-sm font-medium" for="postImage">
        Upload or Take a Photo
       </label>
       <input accept="image/*" capture="environment" class="block w-full text-sm text-gray-900 dark:text-gray-100 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded cursor-pointer focus:outline-none focus:ring-2 focus:ring-indigo-500" id="postImage" type="file"/>
       <label class="block text-sm font-medium" for="postText">
        Add a description or tags
       </label>
       <textarea class="w-full rounded border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 px-3 py-2 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none" id="postText" placeholder="Write something..." rows="3"></textarea>
       <div class="flex justify-end space-x-2">
        <button class="px-4 py-2 rounded border border-gray-400 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500" type="reset">
         Clear
        </button>
        <button class="px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500" type="submit">
         Post
        </button>
       </div>
      </form>
      <div class="flex-1 overflow-auto mt-4 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 p-4">
       <h3 class="font-semibold mb-2">
        Timeline Posts
       </h3>
       <ul class="space-y-4 overflow-auto max-h-[300px]" id="timelinePosts">
        <li class="border border-gray-300 dark:border-gray-700 rounded-lg p-3 bg-indigo-50 dark:bg-indigo-900">
         <img alt="Photo of a mountain sunset with orange and purple sky, pine trees silhouette in foreground" class="rounded mb-2 w-full object-cover" height="200" src="https://storage.googleapis.com/a1aa/image/d47503cc-0842-4f80-9421-6438238b39c5.jpg" width="300"/>
         <p class="text-sm">
          Enjoying the beautiful mountain sunset #nature
         </p>
         <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">
          June 10, 2024
         </div>
        </li>
        <li class="border border-gray-300 dark:border-gray-700 rounded-lg p-3 bg-green-50 dark:bg-green-900">
         <img alt="Photo of a cup of coffee on a wooden table with morning sunlight" class="rounded mb-2 w-full object-cover" height="200" src="https://storage.googleapis.com/a1aa/image/e70d3e90-fcb3-4630-8fb5-b1fe83a8821c.jpg" width="300"/>
         <p class="text-sm">
          Morning coffee break #relax
         </p>
         <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">
          June 9, 2024
         </div>
        </li>
        <li class="border border-gray-300 dark:border-gray-700 rounded-lg p-3 bg-yellow-50 dark:bg-yellow-900">
         <img alt="Photo of city night lights with skyscrapers and busy streets" class="rounded mb-2 w-full object-cover" height="200" src="https://storage.googleapis.com/a1aa/image/b7450a5a-e054-46b9-9d0f-478afa126567.jpg" width="300"/>
         <p class="text-sm">
          City night vibes #urban
         </p>
         <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">
          June 8, 2024
         </div>
        </li>
       </ul>
      </div>
     </section>
     <!-- Groups View -->
     <section class="hidden h-full flex flex-col p-4 space-y-4" id="groupsView">
      <div class="flex justify-between items-center">
       <h2 class="text-lg font-semibold">
        Groups
       </h2>
       <button class="flex items-center space-x-2 px-3 py-1 rounded-md bg-indigo-600 text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500" id="newGroupBtn">
        <i class="fas fa-plus">
        </i>
        <span>
         New Group
        </span>
       </button>
      </div>
      <div class="flex flex-col md:flex-row md:space-x-4 h-full">
       <!-- Groups List -->
       <div class="md:w-1/3 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 flex flex-col">
        <div class="p-2 border-b border-gray-300 dark:border-gray-700 font-semibold">
         Groups
        </div>
        <ul class="flex-1 overflow-auto divide-y divide-gray-200 dark:divide-gray-700" id="groupsList">
         <li class="flex items-center p-2 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900" data-group-id="1">
          <img alt="Group icon for Developers Group, blue circle with white code brackets" class="w-10 h-10 rounded-full object-cover" height="40" src="https://storage.googleapis.com/a1aa/image/423fff6e-ecf3-44f4-8a2c-5a670bdd250c.jpg" width="40"/>
          <div class="ml-3 flex-1">
           <div class="font-semibold">
            Developers Group
           </div>
           <div class="text-xs text-gray-600 dark:text-gray-400">
            5 members
           </div>
          </div>
         </li>
         <li class="flex items-center p-2 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900" data-group-id="2">
          <img alt="Group icon for Friends, green circle with white smiley face" class="w-10 h-10 rounded-full object-cover" height="40" src="https://storage.googleapis.com/a1aa/image/ae1bedd5-81e7-4375-1553-b4087c8f4192.jpg" width="40"/>
          <div class="ml-3 flex-1">
           <div class="font-semibold">
            Friends
           </div>
           <div class="text-xs text-gray-600 dark:text-gray-400">
            8 members
           </div>
          </div>
         </li>
         <li class="flex items-center p-2 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900" data-group-id="3">
          <img alt="Group icon for Family, red circle with white house icon" class="w-10 h-10 rounded-full object-cover" height="40" src="https://storage.googleapis.com/a1aa/image/10436e49-40f4-459a-7812-5f2e0fa497aa.jpg" width="40"/>
          <div class="ml-3 flex-1">
           <div class="font-semibold">
            Family
           </div>
           <div class="text-xs text-gray-600 dark:text-gray-400">
            6 members
           </div>
          </div>
         </li>
         <li class="flex items-center p-2 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900" data-group-id="4">
          <img alt="Group icon for Project Managers, purple circle with white briefcase icon" class="w-10 h-10 rounded-full object-cover" height="40" src="https://storage.googleapis.com/a1aa/image/2e39d6c5-c6ec-47a1-d419-f250877be4ad.jpg" width="40"/>
          <div class="ml-3 flex-1">
           <div class="font-semibold">
            Project Managers
           </div>
           <div class="text-xs text-gray-600 dark:text-gray-400">
            4 members
           </div>
          </div>
         </li>
         <li class="flex items-center p-2 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900" data-group-id="5">
          <img alt="Group icon for Gaming Discord, black circle with white game controller icon" class="w-10 h-10 rounded-full object-cover" height="40" src="https://storage.googleapis.com/a1aa/image/96050ea2-89a5-4cf6-cf35-ffffb560fe80.jpg" width="40"/>
          <div class="ml-3 flex-1">
           <div class="font-semibold">
            Gaming Discord
           </div>
           <div class="text-xs text-gray-600 dark:text-gray-400">
            12 members
           </div>
          </div>
         </li>
        </ul>
       </div>
       <!-- Group Chat Window -->
       <div class="md:flex-1 flex flex-col border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800">
        <div class="p-3 border-b border-gray-300 dark:border-gray-700 flex items-center space-x-3" id="groupChatHeader">
         <img alt="Group avatar" class="w-10 h-10 rounded-full object-cover" height="40" id="groupChatAvatar" src="https://storage.googleapis.com/a1aa/image/5f1f8e8d-0902-4a63-c9d7-d1962f4fb6bc.jpg" width="40"/>
         <div>
          <div class="font-semibold" id="groupChatName">
           Developers Group
          </div>
          <div class="text-xs text-gray-600 dark:text-gray-400" id="groupChatStatus">
           5 members - Active
          </div>
         </div>
        </div>
        <div class="flex-1 p-3 overflow-auto space-y-3" id="groupChatMessages">
         <div class="flex justify-start space-x-2">
          <img alt="Avatar of Alice in group chat" class="w-8 h-8 rounded-full object-cover" height="30" src="https://storage.googleapis.com/a1aa/image/f0a0839a-4856-44af-1893-ff5cd80d81d1.jpg" width="30"/>
          <div class="bg-indigo-100 dark:bg-indigo-700 text-indigo-900 dark:text-indigo-100 rounded-lg px-3 py-2 max-w-xs break-words">
           Hey team, the deadline is approaching!
          </div>
         </div>
         <div class="flex justify-start space-x-2">
          <img alt="Avatar of Bob in group chat" class="w-8 h-8 rounded-full object-cover" height="30" src="https://storage.googleapis.com/a1aa/image/223dc8a1-a0ee-4a2e-4a8c-94414c0b30b4.jpg" width="30"/>
          <div class="bg-indigo-100 dark:bg-indigo-700 text-indigo-900 dark:text-indigo-100 rounded-lg px-3 py-2 max-w-xs break-words">
           Got it, working on the final report.
          </div>
         </div>
         <div class="flex justify-start space-x-2">
          <img alt="Avatar of Charlie in group chat" class="w-8 h-8 rounded-full object-cover" height="30" src="https://storage.googleapis.com/a1aa/image/9c28ded4-66cc-4012-adb6-9d46e493c1a4.jpg" width="30"/>
          <div class="bg-indigo-100 dark:bg-indigo-700 text-indigo-900 dark:text-indigo-100 rounded-lg px-3 py-2 max-w-xs break-words">
           I will review the code today.
          </div>
         </div>
        </div>
        <form class="p-3 border-t border-gray-300 dark:border-gray-700 flex items-center space-x-2" id="groupChatForm">
         <input autocomplete="off" class="flex-1 rounded border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 px-3 py-2 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-500" id="groupChatInput" placeholder="Type a message..." type="text"/>
         <button aria-label="Send Group Message" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded focus:outline-none focus:ring-2 focus:ring-indigo-500" type="submit">
          Send
         </button>
        </form>
       </div>
      </div>
     </section>
     <!-- Profile View -->
     <section class="hidden h-full flex flex-col p-4 space-y-6" id="profileView">
      <h2 class="text-lg font-semibold">
       Profile
      </h2>
      <div class="border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 p-4 space-y-4">
       <div class="flex items-center space-x-4">
        <img alt="User avatar, a smiling person with short hair and glasses" class="w-20 h-20 rounded-full object-cover" height="80" src="https://storage.googleapis.com/a1aa/image/5ac0fefc-7db0-466f-83ba-83298c892d07.jpg" width="80"/>
        <div>
         <div class="text-xl font-semibold">
          You
         </div>
         <div class="text-gray-600 dark:text-gray-400">
          user@example.com
         </div>
        </div>
       </div>
       <div>
        <h3 class="font-semibold mb-2">
         Meshnet Connection Status
        </h3>
        <div class="flex items-center space-x-2 text-green-600 dark:text-green-400" id="meshnetStatus">
         <i class="fas fa-signal">
         </i>
         <span>
          Connected to Meshnet (Private Network)
         </span>
        </div>
       </div>
       <div>
        <h3 class="font-semibold mb-2">
         Encryption Keys
        </h3>
        <button class="px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500" id="generateKeyBtn">
         Generate New Encryption Key
        </button>
        <div class="mt-2 p-2 bg-gray-100 dark:bg-gray-700 rounded break-all select-text text-sm font-mono" id="encryptionKeyDisplay">
        </div>
       </div>
       <div>
        <h3 class="font-semibold mb-2">
         Appearance
        </h3>
        <div class="flex items-center space-x-4">
         <label class="flex items-center space-x-2 cursor-pointer" for="lightModeRadio">
          <input class="form-radio text-indigo-600" id="lightModeRadio" name="theme" type="radio" value="light"/>
          <span>
           Light Mode
          </span>
         </label>
         <label class="flex items-center space-x-2 cursor-pointer" for="darkModeRadio">
          <input class="form-radio text-indigo-600" id="darkModeRadio" name="theme" type="radio" value="dark"/>
          <span>
           Dark Mode
          </span>
         </label>
         <label class="flex items-center space-x-2 cursor-pointer" for="systemModeRadio">
          <input class="form-radio text-indigo-600" id="systemModeRadio" name="theme" type="radio" value="system"/>
          <span>
           System Default
          </span>
         </label>
        </div>
       </div>
      </div>
     </section>
    </section>
   </main>
   <!-- Bottom Navigation -->
   <nav class="flex justify-between items-center border-t border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 px-6 py-2 fixed bottom-0 left-0 right-0 z-30">
    <button aria-label="Home (Calendar)" class="nav-btn flex flex-col items-center text-indigo-600 dark:text-indigo-400 focus:outline-none" id="navHome">
     <i class="fas fa-calendar-alt text-xl">
     </i>
     <span class="text-xs mt-1">
      Home
     </span>
    </button>
    <button aria-label="Chats" class="nav-btn flex flex-col items-center text-gray-600 dark:text-gray-400 focus:outline-none" id="navChats">
     <i class="fas fa-comments text-xl">
     </i>
     <span class="text-xs mt-1">
      Chats
     </span>
    </button>
    <button aria-label="Create Post" class="nav-btn flex flex-col items-center text-gray-600 dark:text-gray-400 focus:outline-none" id="navCreatePost">
     <i class="fas fa-camera text-xl">
     </i>
     <span class="text-xs mt-1">
      Post
     </span>
    </button>
    <button aria-label="Groups" class="nav-btn flex flex-col items-center text-gray-600 dark:text-gray-400 focus:outline-none" id="navGroups">
     <i class="fas fa-users text-xl">
     </i>
     <span class="text-xs mt-1">
      Groups
     </span>
    </button>
    <button aria-label="Profile" class="nav-btn flex flex-col items-center text-gray-600 dark:text-gray-400 focus:outline-none" id="navProfile">
     <i class="fas fa-user text-xl">
     </i>
     <span class="text-xs mt-1">
      Profile
     </span>
    </button>
   </nav>
  </div>
  <script>
   // Theme toggle and persistence
    const htmlEl = document.documentElement;
    const toggleThemeBtn = document.getElementById('toggleThemeBtn');
    const lightModeRadio = document.getElementById('lightModeRadio');
    const darkModeRadio = document.getElementById('darkModeRadio');
    const systemModeRadio = document.getElementById('systemModeRadio');

    function applyTheme(theme) {
      if (theme === 'light') {
        htmlEl.classList.remove('dark');
        lightModeRadio.checked = true;
      } else if (theme === 'dark') {
        htmlEl.classList.add('dark');
        darkModeRadio.checked = true;
      } else {
        // system
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          htmlEl.classList.add('dark');
        } else {
          htmlEl.classList.remove('dark');
        }
        systemModeRadio.checked = true;
      }
      localStorage.setItem('theme', theme);
    }

    function toggleTheme() {
      if (htmlEl.classList.contains('dark')) {
        applyTheme('light');
      } else {
        applyTheme('dark');
      }
    }

    toggleThemeBtn.addEventListener('click', toggleTheme);

    lightModeRadio.addEventListener('change', () => applyTheme('light'));
    darkModeRadio.addEventListener('change', () => applyTheme('dark'));
    systemModeRadio.addEventListener('change', () => applyTheme('system'));

    // Initialize theme on load
    const savedTheme = localStorage.getItem('theme') || 'system';
    applyTheme(savedTheme);

    // Navigation and view switching
    const navButtons = document.querySelectorAll('.nav-btn');
    const views = {
      home: document.getElementById('homeView'),
      chats: document.getElementById('chatsView'),
      createPost: document.getElementById('createPostView'),
      groups: document.getElementById('groupsView'),
      profile: document.getElementById('profileView'),
    };

    function setActiveNav(id) {
      navButtons.forEach((btn) => {
        if (btn.id === id) {
          btn.classList.add('text-indigo-600', 'dark:text-indigo-400');
          btn.classList.remove('text-gray-600', 'dark:text-gray-400');
        } else {
          btn.classList.remove('text-indigo-600', 'dark:text-indigo-400');
          btn.classList.add('text-gray-600', 'dark:text-gray-400');
        }
      });
    }

    function showView(viewName) {
      Object.entries(views).forEach(([key, el]) => {
        if (key === viewName) {
          el.classList.remove('hidden');
        } else {
          el.classList.add('hidden');
        }
      });
    }

    document.getElementById('navHome').addEventListener('click', () => {
      setActiveNav('navHome');
      showView('home');
    });
    document.getElementById('navChats').addEventListener('click', () => {
      setActiveNav('navChats');
      showView('chats');
    });
    document.getElementById('navCreatePost').addEventListener('click', () => {
      setActiveNav('navCreatePost');
      showView('createPost');
    });
    document.getElementById('navGroups').addEventListener('click', () => {
      setActiveNav('navGroups');
      showView('groups');
    });
    document.getElementById('navProfile').addEventListener('click', () => {
      setActiveNav('navProfile');
      showView('profile');
    });

    // Default view
    setActiveNav('navHome');
    showView('home');

    // Calendar view switching
    const calendarViewButtons = document.querySelectorAll('.calendar-view-btn');
    const dayView = document.getElementById('dayView');
    const weekView = document.getElementById('weekView');
    const monthView = document.getElementById('monthView');

    function setCalendarView(view) {
      calendarViewButtons.forEach((btn) => {
        if (btn.dataset.view === view) {
          btn.classList.add('bg-indigo-600', 'text-white');
          btn.classList.remove('border-indigo-600', 'text-indigo-600');
        } else {
          btn.classList.remove('bg-indigo-600', 'text-white');
          btn.classList.add('border-indigo-600', 'text-indigo-600');
        }
      });
      dayView.classList.add('hidden');
      weekView.classList.add('hidden');
      monthView.classList.add('hidden');
      if (view === 'day') dayView.classList.remove('hidden');
      else if (view === 'week') weekView.classList.remove('hidden');
      else if (view === 'month') monthView.classList.remove('hidden');
    }

    calendarViewButtons.forEach((btn) => {
      btn.addEventListener('click', () => {
        setCalendarView(btn.dataset.view);
      });
    });

    // Default calendar view
    setCalendarView('day');

    // Chat connections selection and chat switching
    const connectionsList = document.getElementById('connectionsList');
    const chatAvatar = document.getElementById('chatAvatar');
    const chatName = document.getElementById('chatName');
    const chatStatus = document.getElementById('chatStatus');
    const chatMessages = document.getElementById('chatMessages');

    // Sample chat data for connections
    const chatData = {
      1: {
        name: 'Alice',
        avatar: 'https://placehold.co/40x40/png?text=AL',
        online: true,
        lastSeen: 'now',
        messages: [
          { from: 'them', type: 'text', content: 'Hey! How are you?' },
          { from: 'me', type: 'text', content: "I'm good, thanks! Just working on the project." },
          { from: 'them', type: 'image', content: 'https://placehold.co/150x100/png?text=Image+from+Alice', alt: 'Photo sent by Alice showing a scenic mountain landscape with a clear blue sky' },
          { from: 'me', type: 'text', content: 'Looks amazing! Can you send the file?' },
          { from: 'them', type: 'file', content: 'project-doc.pdf', href: '#', icon: 'fas fa-file-pdf' },
          { from: 'me', type: 'text', content: '👍😊' },
        ],
      },
      2: {
        name: 'Bob',
        avatar: 'https://placehold.co/40x40/png?text=BO',
        online: false,
        lastSeen: '2 hours ago',
        messages: [
          { from: 'them', type: 'text', content: 'Are you coming to the meeting tomorrow?' },
          { from: 'me', type: 'text', content: 'Yes, I will be there.' },
        ],
      },
      3: {
        name: 'Charlie',
        avatar: 'https://placehold.co/40x40/png?text=CH',
        online: true,
        lastSeen: '5 minutes ago',
        messages: [
          { from: 'them', type: 'text', content: 'Did you check the latest code push?' },
          { from: 'me', type: 'text', content: 'Yes, looks good!' },
        ],
      },
      4: {
        name: 'Denise',
        avatar: 'https://placehold.co/40x40/png?text=DE',
        online: false,
        lastSeen: 'yesterday',
        messages: [
          { from: 'them', type: 'text', content: 'Happy birthday!' },
          { from: 'me', type: 'text', content: 'Thank you so much!' },
        ],
      },
      5: {
        name: 'Emily',
        avatar: 'https://placehold.co/40x40/png?text=EM',
        online: true,
        lastSeen: '10 minutes ago',
        messages: [
          { from: 'them', type: 'text', content: 'Let’s catch up soon!' },
          { from: 'me', type: 'text', content: 'Definitely, looking forward to it.' },
        ],
      },
    };

    let currentChatId = 1;

    function renderChatMessages(messages) {
      chatMessages.innerHTML = '';
      messages.forEach((msg) => {
        const msgDiv = document.createElement('div');
        msgDiv.classList.add('max-w-xs', 'break-words');
        if (msg.from === 'me') {
          msgDiv.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-900', 'dark:text-gray-100', 'rounded-lg', 'px-3', 'py-2', 'ml-auto', 'mb-1');
        } else {
          msgDiv.classList.add('bg-indigo-100', 'dark:bg-indigo-700', 'text-indigo-900', 'dark:text-indigo-100', 'rounded-lg', 'px-3', 'py-2', 'mr-auto', 'mb-1');
        }

        if (msg.type === 'text') {
          msgDiv.textContent = msg.content;
        } else if (msg.type === 'image') {
          const img = document.createElement('img');
          img.src = msg.content;
          img.alt = msg.alt || 'Sent image';
          img.className = 'rounded-lg max-w-xs';
          msgDiv.innerHTML = '';
          msgDiv.appendChild(img);
        } else if (msg.type === 'file') {
          const a = document.createElement('a');
          a.href = msg.href || '#';
          a.download = msg.content;
          a.title = `Download ${msg.content}`;
          a.className = 'inline-block truncate';
          a.innerHTML = `<i class="${msg.icon} mr-2"></i>${msg.content}`;
          msgDiv.innerHTML = '';
          msgDiv.appendChild(a);
        }
        chatMessages.appendChild(msgDiv);
      });
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function updateChatHeader(chat) {
      chatAvatar.src = chat.avatar;
      chatAvatar.alt = `Avatar of ${chat.name}`;
      chatName.textContent = chat.name;
      chatStatus.textContent = (chat.online ? 'Online' : 'Offline') + ' - Last seen: ' + chat.lastSeen;
    }

    function selectChat(id) {
      currentChatId = id;
      const chat = chatData[id];
      updateChatHeader(chat);
      renderChatMessages(chat.messages);
      // Highlight selected connection
      connectionsList.querySelectorAll('li').forEach((li) => {
        if (li.dataset.connectionId == id) {
          li.classList.add('bg-indigo-100', 'dark:bg-indigo-900');
        } else {
          li.classList.remove('bg-indigo-100', 'dark:bg-indigo-900');
        }
      });
    }

    connectionsList.querySelectorAll('li').forEach((li) => {
      li.addEventListener('click', () => {
        selectChat(parseInt(li.dataset.connectionId));
      });
    });

    selectChat(currentChatId);

    // Chat form send message
    const chatForm = document.getElementById('chatForm');
    const chatInput = document.getElementById('chatInput');
    const fileInput = document.getElementById('fileInput');
    const attachBtn = document.getElementById('attachBtn');
    const emojiBtn = document.getElementById('emojiBtn');

    attachBtn.addEventListener('click', () => {
      fileInput.click();
    });

    fileInput.addEventListener('change', () => {
      const file = fileInput.files[0];
      if (!file) return;
      if (file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = (e) => {
          chatData[currentChatId].messages.push({ from: 'me', type: 'image', content: e.target.result, alt: file.name });
          renderChatMessages(chatData[currentChatId].messages);
        };
        reader.readAsDataURL(file);
      } else {
        chatData[currentChatId].messages.push({ from: 'me', type: 'file', content: file.name, href: '#', icon: 'fas fa-file' });
        renderChatMessages(chatData[currentChatId].messages);
      }
      fileInput.value = '';
    });

    emojiBtn.addEventListener('click', () => {
      chatInput.value += '😊';
      chatInput.focus();
    });

    chatForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const text = chatInput.value.trim();
      if (text.length === 0) return;
      chatData[currentChatId].messages.push({ from: 'me', type: 'text', content: text });
      renderChatMessages(chatData[currentChatId].messages);
      chatInput.value = '';
    });

    // Create Post form
    const postForm = document.getElementById('postForm');
    const postImageInput = document.getElementById('postImage');
    const postTextInput = document.getElementById('postText');
    const timelinePosts = document.getElementById('timelinePosts');

    postForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const file = postImageInput.files[0];
      if (!file) {
        alert('Please upload or take a photo.');
        return;
      }
      const reader = new FileReader();
      reader.onload = (event) => {
        const li = document.createElement('li');
        li.className = 'border border-gray-300 dark:border-gray-700 rounded-lg p-3 bg-indigo-50 dark:bg-indigo-900';
        const img = document.createElement('img');
        img.src = event.target.result;
        img.alt = postTextInput.value || 'User uploaded photo for calendar timeline post';
        img.className = 'rounded mb-2 w-full object-cover';
        const p = document.createElement('p');
        p.className = 'text-sm';
        p.textContent = postTextInput.value;
        const dateDiv = document.createElement('div');
        dateDiv.className = 'text-xs text-gray-600 dark:text-gray-400 mt-1';
        const now = new Date();
        dateDiv.textContent = now.toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric' });
        li.appendChild(img);
        li.appendChild(p);
        li.appendChild(dateDiv);
        timelinePosts.prepend(li);
        postForm.reset();
      };
      reader.readAsDataURL(file);
    });

    // Groups chat data and UI
    const groupsList = document.getElementById('groupsList');
    const groupChatAvatar = document.getElementById('groupChatAvatar');
    const groupChatName = document.getElementById('groupChatName');
    const groupChatStatus = document.getElementById('groupChatStatus');
    const groupChatMessages = document.getElementById('groupChatMessages');
    const groupChatForm = document.getElementById('groupChatForm');
    const groupChatInput = document.getElementById('groupChatInput');

    const groupsData = {
      1: {
        name: 'Developers Group',
        avatar: 'https://placehold.co/40x40/png?text=DG',
        members: 5,
        active: true,
        messages: [
          { user: 'Alice', avatar: 'https://placehold.co/30x30/png?text=AL', content: 'Hey team, the deadline is approaching!' },
          { user: 'Bob', avatar: 'https://placehold.co/30x30/png?text=BO', content: 'Got it, working on the final report.' },
          { user: 'Charlie', avatar: 'https://placehold.co/30x30/png?text=CH', content: 'I will review the code today.' },
        ],
      },
      2: {
        name: 'Friends',
        avatar: 'https://placehold.co/40x40/png?text=FR',
        members: 8,
        active: true,
        messages: [
          { user: 'Emily', avatar: 'https://placehold.co/30x30/png?text=EM', content: 'Who’s up for a movie night?' },
          { user: 'Denise', avatar: 'https://placehold.co/30x30/png?text=DE', content: 'Count me in!' },
        ],
      },
      3: {
        name: 'Family',
        avatar: 'https://placehold.co/40x40/png?text=FM',
        members: 6,
        active: false,
        messages: [
          { user: 'Mom', avatar: 'https://placehold.co/30x30/png?text=MO', content: 'Don’t forget the reunion next week.' },
          { user: 'You', avatar: 'https://placehold.co/30x30/png?text=ME', content: 'Looking forward to it!' },
        ],
      },
      4: {
        name: 'Project Managers',
        avatar: 'https://placehold.co/40x40/png?text=PM',
        members: 4,
        active: true,
        messages: [
          { user: 'Manager1', avatar: 'https://placehold.co/30x30/png?text=M1', content: 'Please update the project status.' },
          { user: 'Manager2', avatar: 'https://placehold.co/30x30/png?text=M2', content: 'Deadline extended by 2 days.' },
        ],
      },
      5: {
        name: 'Gaming Discord',
        avatar: 'https://placehold.co/40x40/png?text=GD',
        members: 12,
        active: true,
        messages: [
          { user: 'Gamer1', avatar: 'https://placehold.co/30x30/png?text=G1', content: 'Anyone up for a raid tonight?' },
          { user: 'Gamer2', avatar: 'https://placehold.co/30x30/png?text=G2', content: 'Count me in!' },
        ],
      },
    };

    let currentGroupId = 1;

    function renderGroupChatMessages(messages) {
      groupChatMessages.innerHTML = '';
      messages.forEach((msg) => {
        const container = document.createElement('div');
        container.classList.add('flex', 'justify-start', 'space-x-2', 'mb-1');
        const avatar = document.createElement('img');
        avatar.src = msg.avatar;
        avatar.alt = `Avatar of ${msg.user} in group chat`;
        avatar.className = 'w-8 h-8 rounded-full object-cover flex-shrink-0';
        const msgDiv = document.createElement('div');
        msgDiv.className = 'bg-indigo-100 dark:bg-indigo-700 text-indigo-900 dark:text-indigo-100 rounded-lg px-3 py-2 max-w-xs break-words';
        msgDiv.textContent = msg.content;
        container.appendChild(avatar);
        container.appendChild(msgDiv);
        groupChatMessages.appendChild(container);
      });
      groupChatMessages.scrollTop = groupChatMessages.scrollHeight;
    }

    function updateGroupChatHeader(group) {
      groupChatAvatar.src = group.avatar;
      groupChatAvatar.alt = `Group avatar for ${group.name}`;
      groupChatName.textContent = group.name;
      groupChatStatus.textContent = `${group.members} members - ${group.active ? 'Active' : 'Inactive'}`;
    }

    function selectGroup(id) {
      currentGroupId = id;
      const group = groupsData[id];
      updateGroupChatHeader(group);
      renderGroupChatMessages(group.messages);
      // Highlight selected group
      groupsList.querySelectorAll('li').forEach((li) => {
        if (li.dataset.groupId == id) {
          li.classList.add('bg-indigo-100', 'dark:bg-indigo-900');
        } else {
          li.classList.remove('bg-indigo-100', 'dark:bg-indigo-900');
        }
      });
    }

    groupsList.querySelectorAll('li').forEach((li) => {
      li.addEventListener('click', () => {
        selectGroup(parseInt(li.dataset.groupId));
      });
    });

    selectGroup(currentGroupId);

    groupChatForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const text = groupChatInput.value.trim();
      if (text.length === 0) return;
      groupsData[currentGroupId].messages.push({ user: 'You', avatar: 'https://placehold.co/30x30/png?text=ME', content: text });
      renderGroupChatMessages(groupsData[currentGroupId].messages);
      groupChatInput.value = '';
    });

    // New connection button (simulate code generation)
    const newConnectionBtn = document.getElementById('newConnectionBtn');
    newConnectionBtn.addEventListener('click', () => {
      alert('Your private connection code:\n\n' + Math.random().toString(36).substring(2, 10).toUpperCase());
    });

    // New group button (simulate group creation)
    const newGroupBtn = document.getElementById('newGroupBtn');
    newGroupBtn.addEventListener('click', () => {
      const groupName = prompt('Enter new group name:');
      if (!groupName) return;
      const newId = Object.keys(groupsData).length + 1;
      groupsData[newId] = {
        name: groupName,
        avatar: 'https://placehold.co/40x40/png?text=NG',
        members: 1,
        active: true,
        messages: [],
      };
      const li = document.createElement('li');
      li.className = 'flex items-center p-2 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900';
      li.dataset.groupId = newId;
      li.innerHTML = `
        <img src="https://placehold.co/40x40/png?text=NG" alt="Group icon for ${groupName}" class="w-10 h-10 rounded-full object-cover" />
        <div class="ml-3 flex-1">
          <div class="font-semibold">${groupName}</div>
          <div class="text-xs text-gray-600 dark:text-gray-400">1 member</div>
        </div>
      `;
      groupsList.appendChild(li);
      li.addEventListener('click', () => {
        selectGroup(newId);
      });
      selectGroup(newId);
      alert(`Group "${groupName}" created.`);
    });

    // Encryption key generation simulation
    const generateKeyBtn = document.getElementById('generateKeyBtn');
    const encryptionKeyDisplay = document.getElementById('encryptionKeyDisplay');

    function generateEncryptionKey() {
      // Simple random hex string simulating a key
      let key = '';
      const chars = 'abcdef0123456789';
      for (let i = 0; i < 64; i++) {
        key += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return key;
    }

    generateKeyBtn.addEventListener('click', () => {
      const key = generateEncryptionKey();
      encryptionKeyDisplay.textContent = key;
      alert('New encryption key generated and saved securely.');
    });
  </script>
 </body>
</html>
